psql -h localhost -p 5432 -U example -d online-supermarket

CREATE TABLE products (
	id serial PRIMARY KEY,
	name varchar(100),
	price numeric,
	description varchar(100),
	image TEXT,
	rating numeric
);

CREATE TABLE baskets (
	id serial PRIMARY KEY,
);

CREATE TABLE basket_products (
	basket integer REFERENCES public.baskets (id),
	product integer REFERENCES public.products (id),
	quantity integer,
	PRIMARY KEY (basket, product)
);

INSERT INTO products (name, price, description, image, rating) VALUES ('Beans', 0.5, 'Some beans, in a tin', 'a', 2);

INSERT INTO baskets DEFAULT VALUES;
INSERT INTO basket_products (basket, product, quantity) VALUES (1, 1, 2);

SELECT * FROM products;
SELECT * FROM baskets;
SELECT * FROM basket_products;

SELECT CASE WHEN EXISTS(SELECT 1 FROM products) THEN 0 ELSE 1 END AS isempty;
SELECT CASE WHEN EXISTS(SELECT 1 FROM products) THEN False ELSE True END AS is_empty;

SELECT
	ARRAY_AGG(name) products
FROM baskets
INNER JOIN products USING (product)
WHERE id = product
GROUP BY basket;

SELECT bp.basket, bp.product, bp.quantity, p.*
FROM basket_products bp, products p;

SELECT bp.basket, p.name AS product_name, bp.quantity FROM basket_products bp, products p WHERE product = id;
